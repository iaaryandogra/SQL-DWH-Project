-- FIND TOTAL CUSTOMERS BY COUNTRIES
SELECT 
  country,                                   -- Country of the customer
  COUNT(customer_key) AS total_customers     -- Count of unique customers per country
FROM gold.dim_customer
GROUP BY country                              -- Grouping by country to aggregate totals
ORDER BY total_customers DESC;               -- Sort from most to least customers

-- FIND TOTAL CUSTOMERS BY GENDER (same in marital_status)
SELECT 
  new_gen,                                   -- Gender field (standardized)
  COUNT(customer_key) AS total_customers     -- Count of customers per gender
FROM gold.dim_customer
GROUP BY new_gen                             -- Group by gender
ORDER BY total_customers DESC;               -- Sort by count descending

-- FIND TOTAL PRODUCTS BY CATEGORY
SELECT
  category,                                  -- Product category
  COUNT(Product_key) AS total_products       -- Number of products in each category
FROM gold.dim_products
GROUP BY category                             -- Grouping by category
ORDER BY total_products DESC;                -- Sort from most to least products

-- WHAT IS AVERAGE COST IN EACH CATEGORY
SELECT 
  category,                                  -- Product category
  AVG(cost) AS avg_cost                      -- Average cost of products in each category
FROM gold.dim_products
GROUP BY category                             -- Group by category to calculate average
ORDER BY avg_cost DESC;                      -- Sort by average cost descending

-- WHAT IS TOTAL REVENUE GENERATED FOR EACH CATEGORY 
SELECT
  p.category,                                -- Category from the products table
  SUM(f.sales_amount) AS total_revenue       -- Total revenue generated by summing sales
FROM gold.facts_sales f
LEFT JOIN gold.dim_products p 
  ON p.product_key = f.product_key           -- Join on product_key to get category info
GROUP BY p.category                           -- Group by category to summarize revenue
ORDER BY total_revenue DESC;                 -- Sort by highest revenue

-- FIND TOTAL REVENUE GENERATED BY EACH CUSTOMER 
SELECT 
  c.customer_key,                            -- Unique ID of the customer
  c.first_name,                              -- First name of the customer
  c.last_name,                               -- Last name of the customer
  SUM(f.sales_amount) AS total_revenue       -- Total revenue generated by that customer
FROM gold.facts_sales f 
LEFT JOIN gold.dim_customer c 
  ON c.customer_key = f.customer_key         -- Join to get customer details
GROUP BY 
  c.customer_key,
  c.first_name,
  c.last_name                                 -- Grouping by each customer
ORDER BY total_revenue DESC;                 -- Sort by top spenders

-- WHAT IS DISTRIBUTION OF SOLD ITEMS ACROSS COUNTRIES  
SELECT 
  c.country,                                 -- Country of the customer
  SUM(f.quantity) AS total_sold_items        -- Total quantity of items sold to each country
FROM gold.facts_sales f 
LEFT JOIN gold.dim_customer c 
  ON c.customer_key = f.customer_key         -- Join to get country of customer
GROUP BY c.country                            -- Grouping by country
ORDER BY total_sold_items DESC;              -- Sort by number of items sold
